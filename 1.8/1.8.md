# Домашнее задание к занятию «Компоненты Kubernetes»

### Цель задания

Рассчитать требования к кластеру под проект

------

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания:

- [Considerations for large clusters](https://kubernetes.io/docs/setup/best-practices/cluster-large/),
- [Architecting Kubernetes clusters — choosing a worker node size](https://learnk8s.io/kubernetes-node-size).

------

### Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

----
## Расчёт ресурсов для кластера Kubernetes

## 1. Базовые минимальные требования к нодам

| Тип ноды | CPU | RAM | HDD |
| :--- | :-: | :-: | :-: |
| Control Node | 2 ядра | 2 ГБ | 50 ГБ |
| Worker Node | 1 ядро | 1 ГБ | 100 ГБ |

---

## 2. Расчёт ресурсов, необходимых для проекта

| Компонент | CPU (на копию) | RAM (на копию), ГБ | Реплики | Суммарный CPU | Суммарная RAM, ГБ |
| :--- | :-: | :-: | :-: | :-: | :-: |
| База данных | 1 | 4 | 3 | 3 | 12 |
| Кеш | 1 | 4 | 3 | 3 | 12 |
| Фронтенд | 0,2 | 0,05 | 5 | 1 | 0,25 |
| Бекенд | 1 | 0,6 | 10 | 10 | 6 |
| **ИТОГО** | | | | **17** | **30,25** |

---

## 3. Условия отказоустойчивости

Чтобы обеспечить выполнение требования «выход из строя как минимум одной ноды»:
- Принимаем количество **Worker Node = 3**
- Принимаем количество **Control Node = 3** (минимальная конфигурация 2 CPU, 2 RAM)
- Добавляем **запас 40%** к ресурсам приложений. Это позволит пережить потерю одной ноды без ущерба для работоспособности приложения.

---

## 4. Расчёт с учётом запаса 40%

### Суммарные требования к кластеру:
- **CPU:** 17 + 40% = **24 ядра** (округлено в бóльшую сторону)
- **RAM:** 30,25 + 40% = **43 ГБ** (округлено в бóльшую сторону)

### Требования к одной рабочей ноде (Worker):
- **CPU:** 24 / 3 = 8 ядер + 1 ядро (на работу самой ноды) = **9 ядер**
- **RAM:** 43 / 3 ≈ 15 ГБ + 1 ГБ (на работу самой ноды) = **16 ГБ**

---

## 5. Итоговая конфигурация кластера

| Тип ноды | Количество | CPU (1 нода) | RAM (1 нода) |
| :--- | :-: | :-: | :-: |
| **Control Node** | 3 | 2 ядра | 2 ГБ |
| **Worker Node** | 3 | 9 ядер | 16 ГБ |
